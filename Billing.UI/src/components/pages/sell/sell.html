<div class="main-body sell-product base-divide-structure fit-content">
    <div class="content">
        <div class="input-side card">
            <div class="up-side">
                <div class="search-area" e-def="{ findProduct: '' }">
                    <div class="search-field">
                        <span class="fa fa-search"></span>
                        <input type="text" tabindex="1" e-bind="findProduct" placeholder="Nome do Produto ou Codigo">
                    </div>
                    <div class="actions">
                        <button id="reset" on:click="this.cancelSell" class="cancel-type">CANCELAR</button>
                        <button class="next-type">PAUSAR</button>
                        <button class="submit-type" on:click="this.submit(event, 'vpp', 'fpf')">PROFORMA</button>
                        <button class="next-type paused-selling">
                            <i class="fa fa-list-ol"></i>
                            <a :href="/sell/list">Vendas</a>
                        </button>
                    </div>
                </div>
                <div class="product-list product-card-container">
                    <div class="item" e-for="product of products | where:findProduct:name,code"
                        on:click="this.addProductToBusket(product)">
                        <div class="cover" e-style="background-image: url({{ toProductImage(product) }});" e-skeleton></div>
                        <div class="description">
                            <span class="main" e-text="{{ product.name }}" e-skeleton>Loading...</span>
                            <span class="detail1" e-text="{{ product.price }} Kz">Loading...</span>
                            <span class="detail2"
                                e-text="Stock {{ (product.stocks[0] || {}).quantity || 0 }}" e-skeleton>Loading...</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="down-side">
                <app-table class="nav-on" data="$data">
                    <slot slot="table-head">
                        <div class="table-cell" style="flex: 2;"> Produto </div>
                        <div class="table-cell"> Pre√ßo </div>
                        <div class="table-cell"> Quantd. </div>
                        <div class="table-cell"> Desc. </div>
                        <div class="table-cell"> IVA </div>
                        <div class="table-cell"> Subtotal </div>
                        <div class="table-cell" style="flex: .5;"></div>
                    </slot>
                    <slot slot="table-body">
                        <div class="table-row flex-it" e-skeleton e-for="product of busketProducts">
                            <div class="card-cover"></div>
                            <div class="pointer table-cell" style="flex: 2;"> {{ product.name }} </div>
                            <div class="pointer table-cell"> {{ product.price }} kz </div>
                            <div class="pointer table-cell">
                                <span class="complex-cell editable simple">
                                    <input type="number" e-bind="product.qty" value="0">
                                </span>
                            </div>
                            <div class="pointer table-cell">
                                <span class="complex-cell editable descount">
                                    <label>%</label><input style="text-align: left;" type="number" e-bind="product.descount" value="0">
                                </span>
                            </div>
                            <div class="pointer table-cell"> {{ product.iva }} % </div>
                            <div class="pointer table-cell hidable"> {{ product.subtotal }} Kz </div>
                            <div class="table-cell" style="flex: .5;">
                                <span class="remove-line">
                                    <span class="center-icon icon-type fa fa-remove"
                                        on:click="this.removeProductFromBusket(product)"></span>
                                </span>
                            </div>
                        </div>
                    </slot>
                </app-table>
            </div>
        </div>
        <div class="resume-side default-side card nice-scroll">
            <span title="Fechar Resumo" class="reduced-screen-button center-icon fa fa-remove resume-calculador-closer"
                onclick="event.target.parentNode.classList.remove('show-right')"></span>

            <!-- Customer mini card -->
            <div class="customer-card">
                <div class="left">
                    <div class="start">
                        <div class="image"></div>
                    </div>
                    <div class="remain">
                        <div class="main-name" e-text="{{ customer.name }}">Selecione Um Cliente</div>
                        <div class="detail" e-text="{{ customer.idCard }}">Clique em `?` para Selecionar</div>
                    </div>
                </div>
                <div class="right">
                    <span class="center-icon icon-type fa"
                        e-class="{ 'fa-question': customer.id == '', 'fa-check': customer.id != '' }"
                        on:click="this.handleCustomerSelection"></span>
                </div>
            </div>

            <!-- Sale Resume -->
            <div class="sell-resume">
                <div class="row total" e-show="reference">
                    <div class="left">
                        <div>
                            <h3 e-text="Ref: {{ reference }}">Ref: ############</h3>
                        </div>
                    </div>
                </div>

                <div class="row double">
                    <div class="left">
                        <h4>Subtotal</h4>
                        <h3 e-text="{{ sellingResume.subtotal }} Kz">0 Kz</h3>
                    </div>
                    <div class="right">
                        <h4>Desconto</h4>
                        <h3 e-text="{{ sellingResume.descount }} Kz">0 Kz</h3>
                    </div>
                </div>

                <div class="row total">
                    <div class="left">
                        <h3>Total</h3>
                    </div>
                    <div class="right">
                        <h3 e-text="{{ sellingResume.total }} Kz">0 Kz</h3>
                    </div>
                </div>

                <div class="row input">
                    <div class="input-field">
                        <label>Forma de Pagamento</label>
                        <select e-bind="formaPagamentoId" name="FormaPagamentoId" validate="select">
                            <option value="">Selecione a Forma</option>
                            <option e-for="item of paymentWays" value="{{ item.id }}" e-text="{{ item.name }}">Loading...</option>
                        </select>
                    </div>
                </div>

                <div class="calc">
                    <div class="calc-screen">
                        <div class="top">
                            <h4>Valor Pago Em Kz</h4>
                        </div>
                        <div class="remain">
                            <input type="text" e-bind="sellingResume.paid">
                        </div>
                    </div>
                    <div class="calc-buttons">
                        <div class="calc-btn" e-for="item of touchpad.buttons" e-text="{{ item }}"
                            on:click="this.calcButtonClick" val="{{ item }}">?</div>
                    </div>
                </div>

                <div class="row">
                    <div class="left">
                        <h3>Troco</h3>
                    </div>
                    <div class="right" data="sellingResume">
                        <h3 e-class="{ 'negative' : exchange < 0 }" e-text="{{ exchange }} Kz">0 Kz</h3>
                    </div>
                </div>

                <div class="row action-area">
                    <div class="area center">
                        <button on:click="this.submit(event, 'vpp', 'fpp')" class="primary-button">FINALIZAR</button>
                    </div>
                </div>
            </div>

            <div class="fit-content customers-container" e-show="showCustomerSelection">
                <div class="label-back-button">
                    <div class="back-button">
                        <span class="center-icon fa fa-arrow-left" on:click="showCustomerSelection = false"></span>
                    </div>
                    <div class="text">
                        <h3>Selecione um Cliente</h3>
                    </div>
                </div>

                <div class="search-field">
                    <span class="fa fa-search"></span>
                    <input type="text" tabindex="1" e-bind="findCustomer" placeholder="Pesquise por Cliente">
                </div>

                <div class="list-container">
                    <div class="list fit-content-nonspace nice-scroll">
                        <div e-for="item of customers | findCustomer" class="item customer-card"
                            on:click="this.handleCustomerItemClick(item)">
                            <div class="left">
                                <div class="start">
                                    <div class="image"></div>
                                </div>
                                <div class="remain">
                                    <div class="main-name" e-text="{{ item.name }}">Nome Cliente</div>
                                    <div class="detail" e-text="{{ item.company }}">Empresa</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <span title="Resumo da Venda" class="reduced-screen-button center-icon fa fa-calculator resume-calculador"
            onclick="event.target.previousElementSibling.classList.add('show-right');"></span>
    </div>
</div>